introduction last decade several study investigated neurodevelopment psychiatric disorder using brain data acquired via structural magnetic resonance imaging smri analysis shown great potential smri data biomarker one main asset current methodology ability perform relatively precise characterization brain structure essential using structural neuroimaging data understand brain mechanism psychiatric disorder moreover smri biomarkers already important part clinical assessment neurodegenerative disease alzheimer prevalent dementia unfortunately psychiatric disorder still rely solely clinical judgment therefore investigation neuroimaging biomarkers particularly youth may help clinician differentiating typical atypical developmental trajectory quantitative measure could help distinguish typically developing child attention deficit hyperactivity disorder adhd autism spectrum disorder asd furthermore investigation could useful understanding neural basis dimensional symptom psychopathology recent study explored typical neurodevelopment based age estimation smri data convolutional neural network cnn machine-learning model increased brain age estimation correlated increased risk schizophrenia epilepsy syndrome progression alzheimer disease high-risk subject notably decreased predicted age correlated protective influence exerted meditation increased education level physical exercise recent year cnn-based deep learning approach outperformed previous shallow model gaussian process regression estimating brain age smri becoming state art task despite promising result cnns well artificial neural network difficult interpret providing little insight nature neural mechanism underlying psychiatric disorder furthermore generalizability consistency cnn model across different datasets remain open question model trained one dataset performs evaluating distinct datasets remains poorly explored critical clinical use proposed biomarker model trained given dataset perform adequately estimating new unseen subject however new subject always meet characteristic i.e. age sex ethnicity mental health condition included training data furthermore knowing feature model focus making decision essential representative roi estimation roi vary evaluating unseen data representative roi equal different model trained similar versus distinct population answer question relevant making conclusion study much finding generalized similar subject distinct demographic characteristic best knowledge question relatively unexplored neuroimaging data analyzed via cnns especially neurodevelopment stage childhood adulthood current study investigates performance generalizability model trained distinct datasets comprising youth diverse stage neurodevelopment different mental health condition trained cnn model architecture ass asd adhd brain age child behavior checklist cbcl total score previous hypothesis evaluated performance interpretability model within dataset diagnosis task inter-datasets age estimation finally performance relevant brain region interest analyzed discussed light neuroscience material method data description studied data retrieved two public set autism brain imaging data exchange abide-ii adhd-200 two large neurodevelopmental study adolescent brain cognitive development abcd brazilian high-risk cohort study bhrcs used t1-weighted smri data investigated datasets abcd bhrcs datasets data first collection i.e. baseline—wave zero considered abide-ii adhd-200 image collected several location different country including location site abide-ii site adhd-200 thus acquisition parameter abide-ii adhd-200 varied comprising 1.5 scanner hosting head coil channel public datasets found adhd-200 http abide-ii http website abcd data collected multi-brand scanner site usa additional detailed acquisition parameter retrieved abcd http bhrcs data collected two brazilian city using signa hdx 1.5 signa 1.5 scanner detailed acquisition parameter bhrcs found study sato data collected made available according guideline approval local ethic committee project subject focused study neurodevelopmental process youth selected subject younger year age included datasets participant one smri scan within dataset different scanning session used earliest smri subject case data without information sex age psychiatric evaluation i.e. asd adhd cbcl discarded furthermore subject belonged exclusively single dataset overlapping diagnosis subject included different model due multiple disorder i.e. asd adhd filtering arrived following sample size abide-ii adhd-200 bhrcs abcd 11,031 figure show demographic phenotypic overview study data figure demographic phenotypic distribution subject violin plot dotted line show quartile age presented year cbcl raw value acronym typical development apd psychiatric diagnostic cbcl child behavior checklist apd indicates autism spectrum disorder abide-ii attention deficit hyperactivity disorder adhd-200 psychiatric diagnostic dsm-iv dsm-v bhrcs abcd respectively full size image mri processing smri image processed using vbm via statistical parametric mapping software spm12 v7771 http vbm spatially normalizes mri image stereotactic space allowing extraction different brain tissue image partitioned correction nonuniform intensity variation processing step followed recommended script vbm follows first smri data spatially segmented segregate grey matter white matter cerebrospinal fluid csf step skull tissue artifact outside brain removed original image second dartel algorithm applied increase accuracy inter-subject alignment transformation work aligning among image simultaneously aligning generation template data iteratively aligned third resulting file previous step spatially normalized jacobian scaled smoothed gaussian full width half maximum fwhm set generate image montreal neurological institute mni coordinate system transformation smri produced three matrix i.e. csf voxel carrying probable density brain tissue location produced matrix dimension voxel size 1.5 padded trimmed resulting volume transformation affected background voxels outside brain applied best gpu usage http processing done separate batch task i.e. one batch per dataset ensure would bias due interaction example different datasets used resulting data voxels outside brain set zero step conducted ensure data related brain tissue i.e. neurodevelopment data would available model despite potential out-of-brain data improve accuracy model information could add confounding variable analysis therefore opted potentially worse performance favor interpretable reliable result evaluation procedure trained cnn model different datasets perform several task classify mental health status i.e. asd adhd estimate cbcl total score via regression estimate brain age via regression dataset partition training validation testing created nested cross-validation scheme outer cross-validation k-fold inner cross-validation random split training validation therefore advantage robust nested cross-validation preserving lower processing time non-nested schema abide-ii adhd-200 bhrcs datasets assessed fold abcd evaluated fold unlike datasets huge sample size abcd 11,031 allowed use fold maximizing sample size training set still guaranteeing large test sample partition split stratified sex age age continuum variable stratification discretized distribution categorical quantiles subject higher cbcl score positive diagnosis asd adhd see fig additional stratification cbcl asd adhd feasible therefore performed validation set allowed extraction metric model selection test set remained unseen model fully trained therefore performance metric assessed unbiased unexplored data according following schema age regression model abide-ii adhd-200 bhrcs abcd evaluated respective test set best-performing age model one dataset evaluated full independent out-of-sample datasets cbcl regression model bhrcs abcd evaluated respective test set asd classification model abide-ii evaluated respective test set adhd classification model adhd-200 evaluated respective test set fitting additional age model full training datasets evaluate out-of-sample data could improve performance however intended compare result trained model within datasets accordingly chose best-performing age model cross-validation evaluate external datasets potentially losing performance favor comparability addition using k-fold split inner loop cross-validation instead training/validation split followed creating ensemble inner model evaluate test set could increase robustness generalizability however approach would increase training time time opted implement strategy evaluate model performance regression task assessed mae mean absolute error pearson correlation p-value pearson correlation prediction also known cross-validation best ass numerical accuracy regression task classification task assessed sensitivity specificity balanced accuracy mean sensitivity specificity area receiver operating characteristic curve auc chose balanced accuracy instead simple accuracy better evaluate unbalanced data bias model toward classifying minority case majority find best cutoff value used roc operating point selection maximizes harmonic mean sensitivity specificity thus trained model validation data used find optimal cutoff value used classify new test data ran permutation test 1,000 permutation determine value classification prediction accepted statistical significance level alpha adopted approach proposed dinga ass effect confounding variable trained model prediction estimate confounding effect three different model fitted target using confounders predictor using prediction predictor using confounders prediction predictor next coefficient determination regression classification calculated model result separated contribution prediction confounders shared i.e. prediction confounders method reliable even method e.g. method based input variable adjustment fail confounders selected age prediction sex acquisition site total brain volume adhd asd cbcl estimation chosen confounders age sex acquisition site total brain volume model architecture training model architecture used study projected cole architecture chosen designed predict brain age satisfactory performance created optimized studied datasets i.e. abide-ii adhd-200 bhrcs abcd therefore model architecture performance bias toward evaluated datasets summary model architecture contains five block block composed convolutional layer stride rectified linear unit relu convolutional layer stride batch normalization layer relu finally max-pooling layer stride number channel set eight first block doubled max-pooling layer obtain sufficiently rich brain representation final prediction obtained applying fully connected layer map output last block single output value original study doe state value set regularization therefore prevent overfitting adopted kernel regularizers equal 0.001 every convolutional fully connected layer done related study also padded trimmed brain input matrix originally size size aiming memory optimization training performance final output layer chosen according model task regression i.e age cbcl used relu activation mean squared error mse loss function classification i.e. asd adhd used sigmoid activation binary cross-entropy loss function adam algorithm chosen optimize objective loss briefly gradient-based method employ adaptive learning rate adam initial learning rate set 0.001 exponential decay rate first second estimate moment maintained default value i.e. 0.9 0.999 respectively batch size set example example stratified batch level randomly shuffled batch split number epoch set early stopping technique adopted stop training process improvement validation output loss consecutive epoch addition used technique named model checkpoint model evaluated validation set every epoch best-performing model weight saved strategy prevent overfitting storing weight optimal moment training model interpretability address low interpretability level neural network provide little insight nature data used smoothgrad algorithm generates sensitivity map voxels contributes neural network decision measure impact small perturbation input image produce output gradient although similar algorithm e.g. vanilla saliency smoothgrad produce sharper picture due strategy averaging result different noise pattern applied every input picture sensitivity map algorithm often produce gradient signed value however ambiguity converting signed value visualization color gradient direction context-dependent resolve issue adopted absolute value gradient produce clearer picture following smoothgrad author set noise level number noisy sample implementation used study available open-source library named tf-keras-vis available http attention map generated test set corresponding k-fold cross-validations full out-of-sample independent tested datasets cross-validation test set result first averaged within fold normalized averaged across fold resulted one attention map dataset model task i.e. predicting age mental health status one attention map full out-of-sample tested datasets strategy capture common brain structure descriptive model decision-making finally resultant attention map intersected aal3 brain atlas provide roi identification rendered mricron software http provide visualization brain location software hardware specification smri preprocessing done spm12 v7771 software http step used python 3.8.5 tensorflow 2.4.0 http machine learning experiment performed nvidia dgx-2 server within docker virtual machine containing cpu 2.7ghz gpu tesla v100-sxm3-32 source code available github http result demographic phenotypic analysis showed distinct distribution sex age and/or mental health condition dataset see table datasets model trained predict age able learn showing statistically significant correlation predicted target age i.e. 0.45 value 0.001 moreover best-performing age model dataset cross-validation able generalize well independent datasets correlation value 0.001 however model trained predict cbcl able adequately estimate dimensional psychopathology using cbcl total score estimation cbcl bhrcs abcd datasets statistically significant value 0.20 0.07 regarding discrete psychiatric diagnosis model trained abide-ii classify asd presented poor performance value 0.53 auc 0.48 0.09 model trained adhd-200 classify adhd able learn achieving chance metric value 0.02 auc 0.64 0.04 specificity 0.62 0.04 sensitivity 0.59 0.12 balanced accuracy 0.60 0.04 table subject demographic phenotypic information full size table age model one trained adhd-200 achieved best correlation coefficient determination cross-validation 0.84 0.02 prediction 0.62 0.14 considering metric mae abcd model performed best age cross-validation mae 0.47 0.01 year using correlation metric ass generalization capacity abcd model evaluated adhd-200 presented best result 0.80 assessed metric presented table table regression performance metric full size table table classification performance metric full size table confounding analysis conducted planned generating metric table age prediction low confounding effect observed bhrcs ∆confounds 0.07 shared 0.01 abcd ∆confounds 0.04 shared 0.02 however moderate high confounding effect observed adhd-200 ∆confounds 0.05 shared 0.40 abide-ii ∆confounds 0.13 shared 0.55 adhd classification almost performance explained confounders ∆predictions 0.01 ∆confounds 0.22 shared 0.03 model performing above-chance prediction confounders evaluated i.e. asd cbcl model ignored table confounding effect model prediction full size table analyzing top representative roi age estimation found abcd included substantia nigra par compacta par reticulata left right red nucleus left right ventral tegmental area left right raphe nucleus dorsal median abide-ii roi arose paracentral lobule left right superior parietal gyrus left right inferior parietal gyrus right precuneus left right postcentral gyrus right superior occipital gyrus gyrus motor supplementary cortex right adhd-200 roi emerged medial orbital gyrus left right anterior orbital gyrus left gyrus rectus left right middle temporal gyrus left right inferior temporal gyrus left superior parietal gyrus left angular gyrus left interestingly top roi bhrcs right side brain region included temporal gyrus superior middle orbital gyrus anterior posterior medial lateral parietal gyrus superior inferior angular gyrus inferior frontal gyrus opercular part fig figure top representative region age model image reflect model trained abcd bhrcs adhd-200 abide-ii attention map averaged cross-validation model note abcd attention subcortical region acronym left anterior superior full size image better illustrate distribution roi representativeness age model fig depicts un-thresholded attention map brain region within dataset figure heat map importance age model within dataset lighter area indicate representative brain region datasets roi x-axis respectively roi follow aal3 atlas acronym full size image adhd classification adhd-200 data top roi superior parietal gyrus left middle frontal gyrus left superior occipital gyrus right parahippocampal gyrus right angular gyrus right amygdala right ventral tegmental area right median raphe nucleus locus coeruleus right substantia nigra par compacta right however confounding effect see table lead believe roi mostly related confounders i.e. age sex acquisition site total brain volume rather adhd investigate generalization process used best-performing age model dataset extract top representative roi out-of-sample datasets abide-ii adhd-200 model representative roi evaluated datasets abcd bhrcs model almost roi identical datasets word set representative roi model invariant different evaluated datasets list roi presented fig following aal3 acronym figure top representative roi different datasets age prediction list ordered representative roi notice set roi given trained model invariant different datasets little difference roi importance evaluated datasets chosen trained model one best performance cross-validation full size image discussion studied dataset present specific characteristic making unique term demographic phenotypic distribution set unique distribution sex age ethnicity mental health condition i.e. level total cbcl asd adhd moreover datasets composed image collected different site multiple scanner brand model presenting distinct parameter setting despite difference model trained estimate age able show good performance test set generalize reasonably well out-of-sample datasets present almost identical brain roi out-of-sample dataset evaluation however model trained predict cbcl total score able learn bhrcs value 0.20 abcd value 0.07 model trained detect asd also showed below-chance prediction value 0.53 model trained detect adhd above-chance performance value 0.02 however posterior statistical analysis revealed adhd asd prediction almost exclusively influenced confounders see table therefore brain structural difference produced adhd asd dimensional psychopathology assessed cbcl total score captured smri association cnn method employed study comparing performance among different study trivial task different study commonly use distinct method preprocessing step criterion including participant however performance study seems line modern related literature recent study used normative boosting model trained data combining six datasets including abide-ii predict age adolescent resulting mae 1.53 year typical development mae 1.49 at-risk individual aligns result obtained abide-ii cross-validation mae 1.51 another study used multitask learning cnn model predict age obtaining correlation similar achieved cross-validations abide-ii 0.76 0.81 adhd-200 0.84 0.84 furthermore multitask learning study achieved similar correlation abide-ii model predicting adhd-200 0.72 0.71 adhd-200 model predicting abide-ii 0.75 0.76 aside interesting finding best knowledge study current literature evaluate between-dataset performance abcd bhrcs interestingly model capacity estimate age presented statistically significant performance distinct out-of-sample datasets even considering narrow age range abcd bhrcs see fig evidenced analyzing mean correlation obtained model out-of-sample datasets see cross-dataset evaluation table mean correlation presented model cross-dataset evaluation abcd mean 0.67 bhrcs mean 0.59 adhd-200 mean 0.53 abide-ii mean 0.49 interestingly confounded model abcd ∆confounds 0.04 shared 0.02 bhrcs ∆confounds 0.07 shared 0.01 presented better generalization capacity confounded one adhd-200 ∆confounds 0.05 shared 0.40 abide-ii ∆confounds 0.13 shared 0.55 indicate confounded datasets may push model learn robust feature i.e. related confounders result better generalization capacity out-of-sample datasets unexpected finding come observation model trained abcd narrowest age range presented best cross-dataset correlation 0.8 adhd wider age range may occurred due characteristic studied datasets abcd large sample size time bigger studied datasets see section subject whereas small sample size tend deliver better accuracy within dataset large sample size present better generalization power moreover abcd least confounded studied datasets postulate result better generalization capacity observation distribution age see fig lead suppose abcd model perform best bhrcs dataset however abcd bhrcs datasets exclusively collected scanner abcd 1.5 scanner bhrcs guess difference scanner acquisition parameter may contributed abcd lower correlation bhrcs 0.56 contrast influence age distribution reflected directly mae indicator abcd model presented best performance bhrcs mae 1.47 followed adhd-200 mae 2.17 abide-ii mae 2.26 therefore mae indicator seem influenced tendency model predict value nearby center training distribution way mae better lower value datasets whose center distribution closer center distribution training set conversely correlation cross-dataset evaluation appears influenced sample size confounders training set similarity image input feature training test data interesting finding analysis representative roi model evaluated distinct datasets see fig top roi list model trained one dataset distinct roi list model trained datasets could due optimization process i.e. training phase model pushed learn feature best explain target given training data training data distribution distinct one dataset another see fig representative learned feature would one best describe data variability i.e. age sex mental health condition distinct datasets different feature learned model producing different list representative roi dataset contrast representative roi little variability given model evaluated out-of-sample datasets list top roi trained model almost invariable evaluated out-of-sample distinct datasets see fig trained model employ fixed parameter ass dataset therefore difference list roi due variability evaluated data model trained different datasets distinct representative roi evaluated model out-of-sample datasets representative roi remained nearly nevertheless distinct model predict age out-of-sample datasets statistically significant performance moreover structural change enough estimate aging different model whose learned feature based different set representative roi see fig capability estimate age within- inter-datasets model distinct representative roi see fig suggests structural change distributed throughout brain neurodevelopment finding support previous longitudinal study found volume change childhood adulthood neural development involves highly coordinated sequenced event characterized progressive myelination regressive synaptic pruning process two-year-old child synapsis adult synaptic pruning process reduces number synapsis regionally temporarily specific manner resulting efficient connection simultaneously myelination generates protective sheath around nerve axon facilitating speed efficacy neural communication word synaptic pruning myelination process affect density distinct roi different rate neurodevelopment therefore divergence roi representativeness model trained different datasets agree previous neuroscience knowledge except abcd model presented representative roi cortical surface contrast abcd model focused mostly subcortical region specifically midbrain pons see fig even bhrcs model whose datasets demographic similar abcd focused completely different roi abcd model possible explanation difference could distinct nonlinear rate neurodevelopment brain region midbrain pons focused abcd embody primitive role controlling sensory motor function including element visual auditory system furthermore three four major dopaminergic tract originate substantia nigra midbrain whereas bhrcs model focus sparse cortical region specifically right lobe temporal orbital parietal angular inferior frontal gyrus according gogtay analyzed brain maturation childhood adulthood phylogenetically older brain area mature earlier newer one complex brain region tend mature primitive one could also influenced result datasets different distribution subject distinct stage brain maturation model failure detect asd adhd dimensional psychopathology assessed cbcl indicate structural alteration condition subtle heterogeneous enough captured cnns trained smri large datasets psychiatric disorder large heterogeneous data sample tend deliver high confidence generalization power however also lead low accuracy possibly affecting result another potential constraint related capacity cnn internalize complex long-range relationship input feature case possible approach could use transformer-based normative model transformer attention mechanism model dependency input feature without regard distance enabling acquisition complex long-range relationship moreover modeling subject detect psychiatric condition based deviation normality appears good strategy circumvent issue structural heterogeneity psychopathology despite surprising generalization capacity age model estimate out-of-sample datasets given trained datasets diverse demographic variation especially abcd bhrcs age range result interpreted cautiously first significant performance loss occur estimating subject distinct demographic one used training different subject training demographic greater performance loss second representative roi model decision-making strictly specific population used training thus small demographic difference training sample lead trained model focus completely different brain region therefore risky make assumption beyond characteristic population used training model fourth confounders present training data bias model learning process therefore instead learning generalizable feature model learn cofounder scenario cause model lose generalization power exposed non-confounded example keeping limitation mind model trained estimate age satisfactory performance presenting almost identical brain roi out-of-sample dataset evaluation however model could adequately learn estimate brain structural difference produced adhd asd dimensional psychopathology larger longitudinal sample expected provide better estimate however complexity psychiatric symptom syndrome may achievable structural imaging via supervised cnn adolescence adolescence many psychiatric symptom starting emerge early stage making detection even challenging