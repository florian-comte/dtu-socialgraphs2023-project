introduction dementia affect million people worldwide early detection essential deterring disease progression since currently curative treatment available standard neuropsychological screening test mini-mental state examination mmse montreal cognitive assessment moca developed early detection time-consuming require trained personnel administer interpret making difficult administer remote area clock-drawing test cdt classic bedside test cognitive screening monitoring severity dementia high test-retest inter-rater reliability cdt relatively easy administer evaluating interpreting clock drawing straightforward typically requires clinical expertise several scoring system developed adopted aid clock drawing image evaluation including well-accepted shulman scoring system according shulman scoring rubric clock drawing image receives score ranging zero five higher score representing fewer drawing error hence potentially inferring better cognitive function nevertheless clock drawing image may still receive different score different scorer depending interpret rubric especially normal clock drawing drawing minor error consequently experienced scorer clinical expertise typically required often impractical many circumstance necessitating development consistent objective alternative enable consistent subjective cdt assessment several study proposed machine learning pipeline digitize clock drawing data extract geometrical and/or temporal feature data train model supervised manner pipeline demonstrated promising performance task heavily rely human-designed feature shown suboptimal wide range task imagenet large-scale visual recognition consequently deep learning doe require human-designed feature significantly produced cutting-edge outcome image classification task adopted improved cdt assessment despite ability make accurate prediction deep-learning-based technique still make error difficult case instance shulman scoring task majority error due misclassification adjacent clock score clock image visually similar limiting direct application method detection early dementia milder neurocognitive disorder mild cognitive impairment mci work reformulated clock drawing image scoring task fine-grained image classification proposed deep learning framework aim alleviate adjacent clock score misclassification problem especially normal clock drawing drawing minor error particular extended training scheme proposed attentive pairwise interaction network api-net shulman clock scoring task proposed training scheme draw inspiration human frequently compare two image side-by-side detect subtle difference present image pair deep learning model encourage model come data representation later used provide clock score based information image pair contrastive manner contrast prior work train model make prediction without comparative interaction ass performance gained proposed training scheme compared api-net widely-used model consisting vgg16 resnet-152 densenet-121 established state-of-the-art performance shulman scoring task api-net shown improvement f1-score traditional method specifically api-net resnet-152 backbone achieves f1-score 0.79 higher resnet-152 f1-score 0.76 spirit reproducibility made dataset accompanying code available http method data acquisition evaluation clock drawing image collected part paper-based moca assessment 2019–2021 healthy aging cohort neurology outpatient clinic king chulalongkorn memorial hospital bangkok thailand institutional ethic committee approval 0926/64 participant age ranged median age female-to-male ratio 3:1 clock drawing part moca assessment instructed participant draw circular clock number clock hand specifying time 11:10 moca result scanned anonymized cropped include clock drawing part using in-house software image extra information provided participant clinical note test administers excluded resulting total image image given score according shulman scoring rubric majority vote three experienced neuropsychologists/neurologists used model training shulman score classifies clock drawing group depending type abnormality readability drawing normal minor visuo-spatial deficit incorrect representation correct time moderate visuo-spatial deficit severe visuo-spatial deficit reasonable depiction clock number image score example image shown fig figure example clock drawing image shulman score ranging zero five lower score indicating severe cognitive impairment number image score shown score label full size image image preprocessing augmentation acquired clock drawing image resized pixel image augmentation applied increase diversity data used effective model training specifically transformed acquired image varying image brightness contrast shift scale unlike previous work rotate flip clock image augmentation pipeline since transformation could corrupt semantics clock essential accurate clock scoring augmentation process image standardized using mean standard deviation imagenet dataset clock drawing api-net architecture reformulated clock drawing image scoring task fine-grained image classification solved using api-net contrast previous work relies conventional non-contrastive classification pipeline inspired human often compare image pair detect subtle difference image appear similar api-net trained using image pair contrastive manner api-net consists three component backbone api component classifier training phase backbone api component classifier connected sequentially shown fig whereas api component included test phase figure api-net architecture model consists three component backbone component used extract embedding vector input image attentive pairwise interaction api component take embedding vector image pair input creates mutual vector generate gate vector computes four attentive feature vector self self finally classifier component resulting vector predict shulman score predicted score used compute loss function optimizing model parameter full size image backbone component convolutional neural network cnn final classification layer removed backbone act feature extractor take pair visually similar clock drawing image input generates two embedding vector x_1\ x_2\ one image pair api component process two embedding vector based attentive pairwise interaction output four feature vector used classifier produce final clock score pair particular two embedding vector concatenated processed multilayer perceptron mlp consists two fully connected layer dropout layer producing mutual vector potentially contains contrastive detail image pair gate vector computed follows aligned gathered sigmoid i\in 1,2\ gathered aligned hadamard element-wise product using gate original embedding vector four attentive feature vector calculated residual attention mechanism aligned self self aligned embedding vector exploit discriminative clue obtained image pair taking account gate vector image gate vector resulting two attentive feature vector self respectively finally attentive feature vector fed classification layer predicts probability particular class i.e. particular clock score mathematically aligned softmax j\in self i\in 1,2\ aligned model training optimize model parameter loss function described minimized respect parameter based pairwise batch construction procedure demonstrated fig figure embedding pairwise batch construction backbone model embeds image score calculate euclidean distance image embedding vector adjacent score final pairwise batch consist intra-class inter-class image pair used train api-net full size image loss function four prediction vector self self used compute following loss function aligned +\lambda aligned aligned self log aligned aligned max self +\epsilon aligned cross entropy loss score ranking loss regularization parameter balancing two loss one-hot encoded ground-truth label vector image denotes transpose matrix correct class image score-ranking-loss margin cross entropy loss defined employed make sure model predict accurate clock-drawing score using four attentive feature vector score ranking loss used encourage model prioritize self since self activated gate vector intuitively able give accurate clock score image compared activated gate vector image particular score ranking loss doe penalize model predicted probability correct class image obtained self larger obtained least shown embedding pairwise batch construction randomly partitioned whole training set stratified manner batch image batch generated two type image pair intra-class inter-class pair considering image within batch create intra-class image pair combined dissimilar image within class create inter-class image pair combined similar image adjacent class instance clock drawing image score four generated three image pair one intra-class pair included dissimilar image score four one inter-class pair included similar image score three one inter-class pair included similar image score five motivation behind design want encourage model able recognize wide variety image within clock score also distinguish visually similar image different score measured similarity two image based euclidean distance embedding vector two image generated backbone example pairwise batch construction shown fig model inference make prediction new image pas image input backbone get embedding vector pas embedding vector directly trained classifier produce final clock score contrast training phase provided pair image resulting embedding vector passed api component followed classifier procedure conventional cnn classification pipeline except backbone api-net specifically trained suitable fine-grained image classification consent statement study conducted accordance declaration helsinki belmont report cioms guideline international conference harmonization good clinical practice ich-gcp approved ethic committee chulalongkorn university 383/2022 18th march study raw data first extracted hospital information system data collected part routine clinical service patient identity including name patient personal information de-identified approach ensured privacy throughout research process specific consent needed statistical analysis aggregated deidentified data experiment result experiment setting ass performance api-net shulman clock scoring task conducted four main experiment first performed pairwise batch construction strategy experiment investigate effect different batch construction approach model performance benchmarked api-net best-performing pairwise-batch-construction strategy several strong cnn-based baseline including established state-of-the-art performance shulman scoring task assessed performance model fine-grained binary classification task used image score visually similar finally performed interpretability experiment using score-cam one widely-used visualization method generate visual explanation used support model decision experiment conducted five time different stratified random training-validation-test split training data validation data test data according fig acquired clock image score three mitigate class imbalance problem relabeled score relabeling process doe prevent method used cognitive screening tool early detection neurocognitive disorder condition correspond shulman clock score four sensitivity specificity shulman clock score four correspond severe neurocognitive disorder sensitivity specificity 72–100 data preprocessing model training pipeline implemented python executed computer workstation nvidia titan rtx parameter model optimized using adaptive moment estimation adam optimizer performance model evaluated using four metric classification accuracy f1-score precision recall pairwise batch construction strategy experiment compared proposed embedding pairwise batch construction strategy described method section two strategy raw random strategy raw strategy used procedure embedding strategy except changed measured similarity two image specifically raw strategy measured similarity based euclidean distance raw pixel image whereas embedding strategy measured similarity based euclidean distance embedding vector image generated backbone random strategy simply paired image another image within batch random regardless clock score addition three different batch construction strategy also experimented two different set backbone parameter first set pretrained solely imagenet referred imagenet-pretrained backbone second set initially pretrained imagenet later finetuned clock image training dataset epoch termed cdt-finetuned backbone given combination batch construction strategy trained backbone froze parameter backbone trained api component classifier using learning rate 0.00005 batch size contained image class epoch set 0.005 respectively see supplementary table s.1 information effect model performance finally evaluate influence presence intra-class pair compared proposed method used intra-class inter-class pair using inter-class pair performance different batch construction strategy summarized table conducted analysis variance anova test significance level 0.05 compare mean accuracy different strategy obtained p-value 0.0248 rejected null hypothesis stated statistically significant difference mean accuracy different strategy implying least one strategy performance different others used paired two-sample t-test compare mean accuracy proposed strategy embedding strategy cdt-finetuned backbone remaining strategy listed table one time resulting total test performed test null hypothesis mean accuracy proposed strategy equal strategy compared alternative hypothesis mean accuracy proposed strategy higher p-values random strategy imagenet-pretrained backbone cdt-finetuned backbone case 0.006 0.0113 respectively p-values raw strategy imagenet-pretrained backbone cdt-finetuned backbone case 0.0105 0.0064 respectively p-values enabled reject null hypothesis implying embedding strategy cdt-finetuned backbone significantly yielded higher mean accuracy compared random raw strategy table mean standard deviation shulman score classification accuracy f1-scores precision recall obtained api-net different pairwise batch construction strategy backbone different stratified random training-validation-test data splittings full size table p-value embedding strategy imagenet-pretrained backbone case 0.0345 also significance level 0.05 implying proposed embedding strategy cdt-finetuned backbone significantly achieved higher mean accuracy using imagenet-pretrained backbone p-value 0.841 embedding strategy cdt-finetuned backbone trained without intra-class pair case consequently failed reject null hypothesis implying enough evidence support significant difference mean accuracy proposed method intra-class pair included excluded conducted f-test ass variance accuracy obtained null hypothesis variance obtained proposed method intra-pairs included greater equal trained without using intra-pairs according obtained p-value 0.0396 rejected null hypothesis implying enough evidence conclude presence intra-class pair enabled proposed method consistent performance measured reduced variance accuracy light statistical analysis evident optimal batch construction strategy embedding pairwise batch construction strategy cdt-finetuned backbone trained using intra-class inter-class pair method attained peak mean classification accuracy 0.78 complemented f1-score 0.77 precision 0.77 recall 0.77 consequently used embedding strategy cdt-finetuned backbone trained using intra-class inter-class pair remaining experiment shulman score fine-grained classification experiment benchmarked api-net designed fine-grained classification several imagenet-pretrained cnn model consisting vgg16 resnet-152 densenet-121 widely used general image classification task cnn model established state-of-the-art performance shulman score classification considered model strong baseline task baseline model used data image preprocessing image augmentation used api-net fair comparison api-net experimented three backbone architecture consisting vgg16 resnet-152 densenet-121 reflecting selected baseline model compared two different setting api-net training process shown supplementary fig s.1 backbone freezing gradual unfreezing backbone freezing model training exactly used pairwise batch construction strategy experiment word optimized api-net parameter epoch keeping cdt-finetuned backbone fixed gradual unfreezing case updated api classifier component without modifying cdt-finetuned backbone epoch unfroze backbone simultaneously updated three api-net component epoch assessed performance method consideration shulman clock score classification task particularly clock drawing image classified model one three possible score score score score shown table baseline model densenet-121 slightly outperformed vgg16 resnet-152 also observed prior work incorporating api component baseline model along gradual unfreezing strategy improved model performance approximately 2–3 api-net resnet-152 backbone trained gradual unfreezing strategy outperformed method achieving classification accuracy 0.79 f1-score 0.80 precision 0.79 recall 0.79 table mean standard deviation three-class shulman score classification accuracy f1-scores precision recall different stratified random training-validation-test data splittings full size table shulman score score fine-grained binary classification experiment ass effectiveness api-net classifying visually similar image focused image score experiment resnet-152 chosen benchmark backbone api-net api-net trained two different setting backbone freezing gradual unfreezing shown table api-net backbone freezing achieved mean classification accuracy f1-score precision recall 0.80 outperforming method examined compare performance api-net setting benchmark conducted paired two-sample t-tests particular api-net setting null hypothesis mean accuracy api-net equal benchmark alternative hypothesis mean accuracy api-net higher benchmark failed reject null hypothesis p-value 0.7483 gradual unfreezing case able reject null hypothesis p-value 0.0451 backbone freezing case implying api-net backbone freezing significantly yielded higher mean accuracy benchmark experiment gradual unfreezing method underperformance might stem unintentional alteration expertly tuned feature extraction layer backbone especially restricted dataset score potential lack comprehensive representation shulman dataset intricacy might played role layer progressively unlocked vital pretrained knowledge could compromised leading decreased performance nevertheless choice gradual unfreezing backbone freezing training fundamentally rest dataset characteristic used training essentially hyperparameter requires tuning best align dataset use table mean standard deviation clock drawing image classification shulman score accuracy f1-scores precision recall calculated different stratified random training-validation-test data splittings full size table interpretability experiment presently clinician sometimes encounter challenge scoring clock drawing image closely related shulman score ambiguity also present model decision consequently impacting overall performance model navigate challenge make model decision transparent used visualization technique called score-cam section compared score-cam visualization resnet-152 api-net resnet-152 gradual unfreezing highlight superior capability api-net identifying prioritizing irregularity clock drawing image showcasing enhanced model interpretability fig score-cam visualization resnet-152 api-net displayed though model accentuate region exhibiting irregularity clock drawing image manner area highlighted differs significantly two resnet-152 score-cam instance brings large expanse around clock hand focus score obfuscating clear understanding model decision-making process contrast score-cam api-net although highlighting confined area offer much clearer intuitive understanding model rationale disparity particularly pronounced image bearing shulman score bottom row instance api-net score-cam adeptly emphasizes area notable irregularity anomaly resnet-152 version remains fixated inner clock circle area furthermore clock drawing image shulman score range middle top row resnet-152 score-cam indistinctly highlight regular anomalous zone near clock hand contrastingly api-net score-cam specifically zero main irregularity indicated white arrow marker striking illustration seen image 5th column shulman score middle row api-net score-cam emphasizes region encompassing minute hand arrow head specific number hand resnet-152 score-cam broadly accentuates clock hand nuanced distinction underscore api-net advanced capacity differentiate closely similar image capability honed contrastive learning using image pair figure score-cam visualization comparison resnet-152 api-net resnet-152 gradual unfreezing white arrow image pinpoint region deemed influential shulman score according physician observation score-cam visualization api-net offer sharper visual clarity aligns closely region indicated white arrow conversely score-cam visualization resnet-152 seems unfocused appearing spread farther indicated region notable illustration 5th column shulman score middle row score-cam api-net distinctly emphasizes problematic region around clock minute hand score-cam resnet-152 highlight entire clock hand underscore superior precision api-net visualization identifying specific problematic area full size image discussion deep learning model trained standard supervised classification procedure demonstrated impressive performance shulman clock score classification however model sometimes struggle accurately classify image visually alike different score challenge becomes especially significant real-world scenario precise differentiation normal score mild score visuospatial impairment crucial given prevalent occurrence general population drawing inspiration human learning pattern recognition often arises comparing two image discern subtle difference applied contrastive approach train model using image pair crucial aspect successful application api-net effective batch construction strategy experiment model using embedding pairwise batch construction strategy cdt-finetuned backbone outperformed method adopted different strategy table backbone architecture purely convolutional gauging distance embedding space opposed raw pixel space offer resilient metric image similarity especially concerning image translation underpins superior performance embedding strategy relative raw strategy table embedding strategy framework quality backbone used extract image embedding vector greatly affect model performance expectedly cdt-finetuned backbone trained using clock drawing image yielded better performance compared imagenet-pretrained backbone delving designing optimal pairwise batch construction strategy theoretical guarantee compelling avenue future research fall outside purview study despite method superiority baseline potential enhancement remain since main focus early detection neurocognitive disorder mci collected data relatively healthy population result fewer individual score three resulting data scarcity lower score category individual tend score within range address inherent class imbalance real-world data study consolidated clock drawing image score three lower category score indicative severe neurocognitive disorder imperative amass data under-represented score class 0–3 broaden method application across six shulman score class especially monitoring purpose easy directly compare quantitative result reported study several factor first research goal different instance previous study proposed use shulman score dementia screening work used score part cognitive screening tool early detection neurocognitive disorder resulting different score-cutoffs used screening purpose particular drawn clock must receive score perfect score pas early visuo-spatial deficit screening whereas score would sufficient pas dementia screening test proposed study since much harder distinguish image scored image scored would inappropriate directly use quantitative metric screening accuracy compare method moreover study involved different group people potentially different demographic information method recruitment making challenging compare result across study fairly facilitate better benchmarking allow researcher directly compare method made code dataset publicly available http study underscore significance modeling strategy resonates clinical inquiry build effective screening tool early detection essential use modeling strategy focus nuanced difference distinguishing normal clinical population vantage point api-net harnessing contrastive learning distinguish visually similar image appears promising avenue especially dealing case exhibit marginal variation perspective broadened encompass modality speech sound fluid biomarkers brain imaging raise intriguing possibility future work optimizing detection across various medical modality